<!DOCTYPE html>
<html lang="en-US">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>
    Free Connect the Dots Printable Worksheets | Printable Dot to Dot
    Activities
  </title>
  <meta name="description"
    content="Download free connect the dots printable worksheets and dot to dot printables for kids and adults. Our printable dot to dot worksheets are easy to print, no watermarks, and available in PDF format." />
  <meta name="keywords"
    content="connect the dots printable, dot to dot printables, dot to dot worksheets, free printable connect the dots, connect the dots print" />
  <meta name="author" content="Connect the Dots Printable" />
  <meta name="robots" content="index, follow" />
  <meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
  <meta property="og:title" content="Free Connect the Dots Printable Worksheets" />
  <meta property="og:description"
    content="Download free connect the dots printable worksheets for kids and adults. Printable dot to dot activities in PDF format with no watermarks." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://connectthedotsprintable.online/" />
  <meta property="og:image" content="https://connectthedotsprintable.online/images/og-image.jpg" />
  <link rel="canonical" href="https://connectthedotsprintable.online/" />
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="canonical" href="https://connectthedotsprintable.online/" />
  <meta name="google-adsense-account" content="ca-pub-3383070348689557" />
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-CM76E2ZP8E"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-CM76E2ZP8E');
</script>
  <script src="./js/opencv.js"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: "#4F46E5",
            secondary: "#EC4899",
            accent: "#F59E0B",
            neutral: "#1F2937",
            light: "#F9FAFB",
          },
          fontFamily: {
            nunito: ["Nunito", "sans-serif"],
          },
        },
      },
    };
  </script>
  <style type="text/tailwindcss">
    @layer utilities {
        .content-auto {
          content-visibility: auto;
        }
        .text-shadow {
          text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .card-hover {
          transition: all 0.3s ease;
        }
        .card-hover:hover {
          transform: translateY(-5px);
        }
      }
    </style>

  <style>
    .preview-container {
      position: relative;
      border: 1px solid #ccc;
      background-color: white;
    }

    .preview-container canvas {
      position: absolute;
      top: 0;
      left: 0;
      display: none;
    }

    .control-group {
      margin-bottom: 20px;
    }

    label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
    }

    #loader {
      font-style: italic;
      color: #555;
    }
  </style>

  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3383070348689557"
    crossorigin="anonymous"></script>

  <script type="text/javascript">
    (function (c, l, a, r, i, t, y) {
      c[a] =
        c[a] ||
        function () {
          (c[a].q = c[a].q || []).push(arguments);
        };
      t = l.createElement(r);
      t.async = 1;
      t.src = "https://www.clarity.ms/tag/" + i;
      y = l.getElementsByTagName(r)[0];
      y.parentNode.insertBefore(t, y);
    })(window, document, "clarity", "script", "tf6ljm5fsf");
  </script>
</head>

<body>
  <header class="sticky top-0 z-50 bg-white shadow-md">
    <div class="container mx-auto px-4 py-3 flex flex-wrap items-center justify-between">
      <a href="/" class="flex items-center">
        <i class="fas fa-pencil-ruler text-primary text-3xl mr-2"></i>
        <span class="text-xl font-bold text-primary">ConnectTheDotsPrintable.online</span>
      </a>

      <!-- Desktop Navigation -->
      <nav class="hidden md:flex space-x-6">
        <a href="/" class="font-medium hover:text-primary transition">Home</a>
        <a href="/printable-connect-the-dots.html" class="font-medium text-primary hover:text-primary/80 transition">All
          Printables</a>
        <a href="#" class="font-medium hover:text-primary transition">Worksheets</a>
        <a href="#" class="font-medium hover:text-primary transition">Free Downloads</a>
        <a href="#" class="font-medium hover:text-primary transition">Custom Generator</a>
      </nav>

      <!-- Mobile menu button -->
      <button id="mobile-menu-button" class="md:hidden text-neutral hover:text-primary">
        <i class="fas fa-bars text-2xl"></i>
      </button>
    </div>

    <!-- Mobile Navigation -->
    <div id="mobile-menu" class="hidden md:hidden bg-white border-t">
      <div class="container mx-auto px-4 py-2 flex flex-col space-y-3">
        <a href="/" class="py-2 font-medium hover:text-primary transition">Home</a>
        <a href="/printable-connect-the-dots.html" class="py-2 font-medium text-primary">All Printables</a>
        <a href="#" class="py-2 font-medium hover:text-primary transition">Worksheets</a>
        <a href="#" class="py-2 font-medium hover:text-primary transition">Free Downloads</a>
        <a href="#" class="py-2 font-medium hover:text-primary transition">Custom Generator</a>
      </div>
    </div>
  </header>

  <main>
    <!-- Hero Section -->
    <section class="bg-gradient-to-r from-primary to-primary/80 text-white py-16 md:py-24">
      <div class="container mx-auto px-4">
        <div class="flex flex-col md:flex-row items-center">
          <div class="md:w-1/2 mb-10 md:mb-0">
            <h1 class="text-[clamp(2rem,5vw,3.5rem)] font-bold leading-tight text-shadow mb-4">
              Free Connect the Dots Printable Worksheets
            </h1>
            <p class="text-xl mb-8 text-white/90">
              Download high-quality dot to dot printables for kids and adults.
              Instant access to printable connect the dots activities with no
              watermarks.
            </p>
            <div class="flex flex-wrap gap-4">
              <a href="#"
                class="bg-white text-primary px-6 py-3 rounded-lg font-semibold hover:bg-opacity-90 transition shadow-lg">
                <i class="fas fa-download mr-2"></i>Browse All Printables
              </a>
              <a href="#controlsPanelsuser"
                class="bg-secondary text-white px-6 py-3 rounded-lg font-semibold hover:bg-secondary/90 transition shadow-lg">
                <i class="fas fa-magic mr-2"></i>Create Custom Dots
              </a>
            </div>
          </div>
          <div class="md:w-1/2">
            <img src="./image/1 Family Enjoying Connect the Dots Activities1.png"
              alt="Family enjoying connect the dots activities - free printable worksheets for kids and adults | connectthedotsprintable.online"
              class="rounded-xl shadow-2xl w-full h-auto" />
          </div>
        </div>
      </div>
    </section>
    <section class="py-16 bg-white max-w-7xl mx-auto w-full flex flex-col lg:flex-row gap-8" id="controlsPanelsuser">
      <!-- ===== Controls Panel ===== -->
      <!-- ===== Controls Panel ===== -->
      <div class="controls lg:w-96 flex-shrink-0 bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg space-y-6">
        <div class="control-group">
          <label class="block text-lg font-semibold mb-2 text-gray-900 dark:text-white">1. Select Image</label>
          <!-- **【重要修改】自定义文件输入按钮** -->
          <div class="flex items-center">
            <!-- 隐藏真正的 input -->
            <input type="file" id="imageLoader" accept="image/*" class="hidden" />
            <!-- 这是我们自定义的、漂亮的“按钮”，它是一个 label -->
            <label for="imageLoader"
              class="cursor-pointer bg-blue-50 dark:bg-blue-900/40 text-blue-700 dark:text-blue-300 font-semibold text-sm py-2 px-4 rounded-full hover:bg-blue-100 dark:hover:bg-blue-900/60 transition-colors duration-200">
              Choose File
            </label>
            <!-- 用于显示所选文件名的区域 -->
            <span id="fileName" class="ml-4 text-sm text-gray-500 dark:text-gray-400 truncate">No file chosen</span>
          </div>
        </div>

        <div class="control-group">
          <label class="block text-lg font-semibold mb-3 text-gray-900 dark:text-white">2. Hint Type</label>
          <div class="space-y-2">
            <div class="flex items-center">
              <input type="radio" id="hintNo" name="imageHint" value="no" checked
                class="h-4 w-4 text-blue-600 border-gray-300 dark:border-gray-600 focus:ring-blue-500 dark:focus:ring-offset-gray-800" />
              <label for="hintNo" class="ml-3 block text-sm font-medium">No (Dots Only)</label>
            </div>
            <div class="flex items-center">
              <input type="radio" id="hintTrace" name="imageHint" value="trace"
                class="h-4 w-4 text-blue-600 border-gray-300 dark:border-gray-600 focus:ring-blue-500 dark:focus:ring-offset-gray-800" />
              <label for="hintTrace" class="ml-3 block text-sm font-medium">Trace (Outline)</label>
            </div>
            <div class="flex items-center">
              <input type="radio" id="hintContrast" name="imageHint" value="contrast"
                class="h-4 w-4 text-blue-600 border-gray-300 dark:border-gray-600 focus:ring-blue-500 dark:focus:ring-offset-gray-800" />
              <label for="hintContrast" class="ml-3 block text-sm font-medium">Contrast (Thresholded)</label>
            </div>
          </div>
        </div>

        <div class="control-group">
          <label for="thresholdSlider" class="block text-lg font-semibold mb-2 text-gray-900 dark:text-white">3. Adjust
            Threshold</label>
          <div class="flex items-center gap-4">
            <input type="range" id="thresholdSlider" min="1" max="254" value="128"
              class="w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-lg appearance-none cursor-pointer" />
            <span id="thresholdValue"
              class="font-mono text-sm bg-gray-200 dark:bg-gray-700 rounded-md px-2.5 py-1 w-12 text-center">128</span>
          </div>
        </div>

        <div class="control-group">
          <label for="pointCountSlider" class="block text-lg font-semibold mb-2 text-gray-900 dark:text-white">4. Number
            of Points</label>
          <div class="flex items-center gap-4">
            <input type="range" id="pointCountSlider" min="10" max="100" value="30" step="1"
              class="w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-lg appearance-none cursor-pointer" />
            <span id="pointCountValue"
              class="font-mono text-sm bg-gray-200 dark:bg-gray-700 rounded-md px-2.5 py-1 w-12 text-center">18</span>
          </div>
        </div>

        <div class="control-group">
          <label for="traceAmountSlider" class="block text-lg font-semibold mb-2 text-gray-900 dark:text-white">5. Trace
            Amount (%)</label>
          <div class="flex items-center gap-4">
            <input type="range" id="traceAmountSlider" min="0" max="100" value="50" step="1"
              class="w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-lg appearance-none cursor-pointer" />
            <span id="traceAmountValue"
              class="font-mono text-sm bg-gray-200 dark:bg-gray-700 rounded-md px-2.5 py-1 w-12 text-center">50</span>
          </div>
        </div>
      </div>

      <!-- ===== Preview Area ===== -->
      <div class="flex-1 min-w-0 p-4">
        <div class="flex justify-between items-center mb-4">
          <h2 class="text-3xl font-bold text-gray-900 dark:text-white">
            Preview
          </h2>
          <button id="downloadBtn" disabled
            class="inline-flex items-center gap-2 bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-100 dark:focus:ring-offset-gray-900 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd"
                d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z"
                clip-rule="evenodd" />
            </svg>
            Download PNG
          </button>
        </div>
        <div id="previewContainer"
          class="preview-container w-full aspect-video bg-white dark:bg-gray-800 rounded-2xl shadow-inner border border-gray-200 dark:border-gray-700 relative flex items-center justify-center">
          <div id="placeholder" class="text-gray-400 dark:text-gray-500">
            Select an image on the left to get started
          </div>
          <canvas id="contrastCanvas" class="rounded-2xl"></canvas>
          <canvas id="traceCanvas" class="rounded-2xl"></canvas>
          <canvas id="dotsCanvas" class="rounded-2xl"></canvas>
        </div>
        <div id="loader" class="text-center mt-4 text-sm text-gray-500 dark:text-gray-400">
          OpenCV.js is loading...
        </div>
      </div>
    </section>

    <!-- Features Section -->
    <section class="py-16 bg-white">
      <div class="container mx-auto px-4">
        <div class="text-center mb-16">
          <h2 class="text-[clamp(1.8rem,4vw,2.5rem)] font-bold mb-4">
            Why Choose Our Connect the Dots Printables?
          </h2>
          <p class="text-lg text-neutral/70 max-w-3xl mx-auto">
            We offer the best collection of printable dot to dot worksheets
            for all ages and skill levels
          </p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
          <div class="bg-light p-8 rounded-xl shadow-md card-hover">
            <div class="w-14 h-14 bg-primary/10 rounded-full flex items-center justify-center mb-6">
              <i class="fas fa-download text-primary text-2xl"></i>
            </div>
            <h3 class="text-xl font-bold mb-3">Instant Download</h3>
            <p class="text-neutral/70">
              Get your connect the dots printables immediately. Available in
              PDF and high-resolution image formats.
            </p>
          </div>

          <div class="bg-light p-8 rounded-xl shadow-md card-hover">
            <div class="w-14 h-14 bg-secondary/10 rounded-full flex items-center justify-center mb-6">
              <i class="fas fa-check-circle text-secondary text-2xl"></i>
            </div>
            <h3 class="text-xl font-bold mb-3">No Watermarks</h3>
            <p class="text-neutral/70">
              All our dot to dot printables are completely free of watermarks
              for clean, professional printing.
            </p>
          </div>

          <div class="bg-light p-8 rounded-xl shadow-md card-hover">
            <div class="w-14 h-14 bg-accent/10 rounded-full flex items-center justify-center mb-6">
              <i class="fas fa-paint-brush text-accent text-2xl"></i>
            </div>
            <h3 class="text-xl font-bold mb-3">Custom Designs</h3>
            <p class="text-neutral/70">
              Create your own custom connect the dots printables with our
              easy-to-use generator tool.
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- Categories Section -->
    <section class="py-16 bg-gray-50">
      <div class="container mx-auto px-4">
        <div class="flex justify-between items-center mb-10">
          <h2 class="text-[clamp(1.8rem,4vw,2.5rem)] font-bold">
            Popular Connect the Dots Categories
          </h2>
          <!-- <a href="#" class="text-primary font-semibold hover:underline flex items-center">
            View All <i class="fas fa-arrow-right ml-2"></i>
          </a> -->
        </div>

        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
          <!-- Category 1 -->
          <div class="block group" target="_blank" download>
            <div class="relative rounded-xl overflow-hidden shadow-md h-64 mb-3">
              <img
                src="./image/2 Colorful Connect the Dots for Kids Simple Animal and Cartoon Characters (1-20 dots).png"
                alt="Kids connect the dots printables - easy animal designs for children | connectthedotsprintable.online"
                class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110" />
              <div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent"></div>
              <div class="absolute bottom-0 left-0 p-4 text-white">
                <h3 class="font-bold text-xl">Kids Connect the Dots</h3>
                <p class="text-sm text-white/80">Easy designs for children</p>
                <div class="flex items-center mt-2 gap-3">
                  <a href="./KidsConnecttheDots.pdf" target="_blank" download="KidsConnecttheDots.pdf"
                    class=" bg-primary text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-primary/90 transition"
                    download>
                    <i class="fas fa-download mr-1"></i>
                    dowload
                  </a>
                  <a href="./KidsConnecttheDots.pdf" target="_blank"
                    class=" bg-accent text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-primary/90 transition">
                    <i class="fas fa-file-pdf mr-1"></i>
                    Preview
                  </a>
                </div>

              </div>
            </div>
          </div>

          <!-- Category 2 -->
          <div class="block group">
            <div class="relative rounded-xl overflow-hidden shadow-md h-64 mb-3">
              <img src="./image/3 Intricate Connect the Dots Mandala for Adults (Over 100 dots).png"
                alt="Adult connect the dots printables - complex mandala designs for relaxation | connectthedotsprintable.online"
                class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110" />
              <div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent"></div>
              <div class="absolute bottom-0 left-0 p-4 text-white">
                <h3 class="font-bold text-xl">Adult Dot to Dot</h3>
                <p class="text-sm text-white/80">
                  Complex designs for adults
                </p>
                <div class="flex items-center mt-2 gap-3">
                  <a href="./AdultDottoDot.pdf" target="_blank" download="AdultDottoDot.pdf"
                    class=" bg-primary text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-primary/90 transition"
                    download>
                    <i class="fas fa-download mr-1"></i>
                    dowload
                  </a>
                  <a href="./AdultDottoDot.pdf" target="_blank"
                    class=" bg-accent  text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-primary/90 transition">
                    <i class="fas fa-file-pdf mr-1"></i>
                    Preview
                  </a>
                </div>
              </div>
            </div>
          </div>

          <!-- Category 3 -->
          <div class="block group">
            <div class="relative rounded-xl overflow-hidden shadow-md h-64 mb-3">
              <img src="./image/4 educational connect the dots worksheet featuring letters and numbers.png"
                alt="Educational dot to dot worksheets - learn letters and numbers through play | connectthedotsprintable.online"
                class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110" />
              <div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent"></div>
              <div class="absolute bottom-0 left-0 p-4 text-white">
                <h3 class="font-bold text-xl">Educational Worksheets</h3>
                <p class="text-sm text-white/80">Learning through play</p>
                <div class="flex items-center mt-2 gap-3">
                  <a href="./EducationalWorksheets.pdf" target="_blank" download="EducationalWorksheets.pdf"
                    class=" bg-primary text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-primary/90 transition"
                    download>
                    <i class="fas fa-download mr-1"></i>
                    dowload
                  </a>
                  <a href="./EducationalWorksheets.pdf" target="_blank"
                    class=" bg-accent  text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-primary/90 transition">
                    <i class="fas fa-file-pdf mr-1"></i>
                    Preview
                  </a>
                </div>
              </div>
            </div>
          </div>

          <!-- Category 4 -->
          <div class="block group">
            <div class="relative rounded-xl overflow-hidden shadow-md h-64 mb-3">
              <img src="./image/5 Holiday Themed Connect the Dots Christmas Tree and Festive Elements.png"
                alt="Themed connect the dots printables - holiday and seasonal designs | connectthedotsprintable.online"
                class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110" />
              <div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent"></div>
              <div class="absolute bottom-0 left-0 p-4 text-white">
                <h3 class="font-bold text-xl">Themed Printables</h3>
                <p class="text-sm text-white/80">Holidays, animals & more</p>
                <div class="flex items-center mt-2 gap-3">
                  <a href="./ThemedPrintables.pdf" target="_blank" download="ThemedPrintables.pdf"
                    class=" bg-primary text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-primary/90 transition"
                    download>
                    <i class="fas fa-download mr-1"></i>
                    dowload
                  </a>
                  <a href="./ThemedPrintables.pdf" target="_blank"
                    class=" bg-accent  text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-primary/90 transition">
                    <i class="fas fa-file-pdf mr-1"></i>
                    Preview
                  </a>
                </div>

              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Featured Printables -->
    <section class="py-16 bg-white">
      <div class="container mx-auto px-4">
        <h2 class="text-[clamp(1.8rem,4vw,2.5rem)] font-bold mb-10">
          Featured Connect the Dots Printables
        </h2>

        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
          <!-- Printable 1 -->
          <div class="bg-light rounded-xl overflow-hidden shadow-md card-hover">
            <div class="relative">
              <img src="./image/6 Cute Bunny Rabbit Connect the Dots for Young Children (1-20 dots).png"
                alt="Easy animal connect the dots printable - cute bunny design for kids | connectthedotsprintable.online"
                class="w-full h-56 object-cover" />
              <span
                class="absolute top-3 right-3 bg-accent text-white text-sm font-semibold px-3 py-1 rounded-full">Free</span>
            </div>
            <div class="p-6">
              <h3 class="text-xl font-bold mb-2">Animal Connect the Dots</h3>
              <p class="text-neutral/70 mb-4">
                Simple dot to dot printable for young children with cute
                animal designs.
              </p>
              <div class="flex flex-wrap gap-2 mb-4">
                <span class="bg-primary/10 text-primary text-xs px-3 py-1 rounded-full">For Kids</span>
                <span class="bg-primary/10 text-primary text-xs px-3 py-1 rounded-full">Easy</span>
                <span class="bg-primary/10 text-primary text-xs px-3 py-1 rounded-full">Animals</span>
              </div>
              <div class="flex justify-between items-center">
                <span class="text-sm text-neutral/60">
                  <i class="fas fa-download mr-1"></i> 2.5k downloads
                </span>
                <!-- MODIFIED FOR DOWNLOAD -->
                <a href="./AnimalConnecttheDots.pdf" target="_blank" download
                  class="bg-primary text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-primary/90 transition"
                  data-img-src="./AnimalConnecttheDots.pdf">
                  <i class="fas fa-download mr-1"></i> Download
                </a>
              </div>
            </div>
          </div>

          <!-- Printable 2 -->
          <div class="bg-light rounded-xl overflow-hidden shadow-md card-hover">
            <div class="relative">
              <img src="./image/7 Festive Christmas Tree Connect the Dots Design (1-50 dots).png"
                alt="Christmas tree dot to dot printable - festive holiday activity for families | connectthedotsprintable.online"
                class="w-full h-56 object-cover" />
              <span
                class="absolute top-3 right-3 bg-accent text-white text-sm font-semibold px-3 py-1 rounded-full">Free</span>
            </div>
            <div class="p-6">
              <h3 class="text-xl font-bold mb-2">Christmas Dot to Dot</h3>
              <p class="text-neutral/70 mb-4">
                Festive Christmas themed connect the dots printable for all
                ages.
              </p>
              <div class="flex flex-wrap gap-2 mb-4">
                <span class="bg-primary/10 text-primary text-xs px-3 py-1 rounded-full">Holiday</span>
                <span class="bg-primary/10 text-primary text-xs px-3 py-1 rounded-full">Medium</span>
                <span class="bg-primary/10 text-primary text-xs px-3 py-1 rounded-full">Christmas</span>
              </div>
              <div class="flex justify-between items-center">
                <span class="text-sm text-neutral/60">
                  <i class="fas fa-download mr-1"></i> 1.8k downloads
                </span>
                <!-- MODIFIED FOR DOWNLOAD -->
                <a href="./ChristmasDottoDot.pdf" target="_blank" download
                  class="  bg-primary text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-primary/90 transition"
                  data-img-src="./ChristmasDottoDot.pdf">
                  <i class="fas fa-download mr-1"></i> Download
                </a>
              </div>
            </div>
          </div>

          <!-- Printable 3 -->
          <div class="bg-light rounded-xl overflow-hidden shadow-md card-hover">
            <div class="relative">
              <img src="./image/8 Advanced Mandala Connect the Dots Design for Adults (Over 100 dots).png"
                alt="Advanced mandala connect the dots - complex design for adults | connectthedotsprintable.online"
                class="w-full h-56 object-cover" />
              <span
                class="absolute top-3 right-3 bg-accent text-white text-sm font-semibold px-3 py-1 rounded-full">Free</span>
            </div>
            <div class="p-6">
              <h3 class="text-xl font-bold mb-2">Advanced Mandala Dots</h3>
              <p class="text-neutral/70 mb-4">
                Complex connect the dots printable for adults with mandala
                design.
              </p>
              <div class="flex flex-wrap gap-2 mb-4">
                <span class="bg-primary/10 text-primary text-xs px-3 py-1 rounded-full">Adults</span>
                <span class="bg-primary/10 text-primary text-xs px-3 py-1 rounded-full">Hard</span>
                <span class="bg-primary/10 text-primary text-xs px-3 py-1 rounded-full">Mandala</span>
              </div>
              <div class="flex justify-between items-center">
                <span class="text-sm text-neutral/60">
                  <i class="fas fa-download mr-1"></i> 3.2k downloads
                </span>
                <!-- MODIFIED FOR DOWNLOAD -->
                <a href="./AdvancedMandalaDots.pdf" target="_blank" download
                  class="bg-primary text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-primary/90 transition"
                  data-img-src="./AdvancedMandalaDots.pdf">
                  <i class="fas fa-download mr-1"></i> Download
                </a>
              </div>
            </div>
          </div>
        </div>

        <div class="text-center mt-10">
          <a href="/printable-connect-the-dots.html"
            class="inline-flex items-center bg-white border-2 border-primary text-primary px-6 py-3 rounded-lg font-semibold hover:bg-primary hover:text-white transition">
            View All Connect the Dots Printables
            <i class="fas fa-arrow-right ml-2"></i>
          </a>
        </div>
      </div>
    </section>

    <!-- Custom Generator Section -->
    <section class="py-16 bg-gray-50">
      <div class="container mx-auto px-4">
        <div class="bg-white rounded-2xl shadow-lg overflow-hidden">
          <div class="flex flex-col lg:flex-row">
            <div class="lg:w-1/2 p-8 lg:p-12 flex flex-col justify-center">
              <h2 class="text-[clamp(1.8rem,4vw,2.5rem)] font-bold mb-6">
                Create Your Own Connect the Dots Printables
              </h2>
              <p class="text-lg text-neutral/70 mb-8">
                Our custom connect the dots generator lets you transform any
                image into a printable dot to dot worksheet. Perfect for
                creating personalized activities for kids, educational
                materials, or unique adult coloring pages.
              </p>
              <ul class="space-y-4 mb-8">
                <li class="flex">
                  <div class="bg-green-100 p-2 rounded-full mr-3">
                    <i class="fas fa-check text-green-600"></i>
                  </div>
                  <div>
                    <h4 class="font-bold text-sm">Upload your own images</h4>
                    <p class="text-xs text-neutral/70">
                      Turn photos or illustrations into connect the dots
                    </p>
                  </div>
                </li>
                <li class="flex">
                  <div class="bg-green-100 p-2 rounded-full mr-3">
                    <i class="fas fa-check text-green-600"></i>
                  </div>
                  <div>
                    <h4 class="font-bold text-sm">Adjust difficulty level</h4>
                    <p class="text-xs text-neutral/70">
                      Control the number of dots for any skill level
                    </p>
                  </div>
                </li>
                <li class="flex">
                  <div class="bg-green-100 p-2 rounded-full mr-3">
                    <i class="fas fa-check text-green-600"></i>
                  </div>
                  <div>
                    <h4 class="font-bold text-sm">
                      Custom designs in seconds
                    </h4>
                    <p class="text-xs text-neutral/70">
                      Turn any image into a connect the dots printable
                    </p>
                  </div>
                </li>
              </ul>
              <a href="#controlsPanelsuser"
                class="bg-secondary text-white px-6 py-3 rounded-lg font-semibold hover:bg-secondary/90 transition self-start">
                <i class="fas fa-magic mr-2"></i>Try Custom Generator
              </a>
            </div>
            <div class="lg:w-1/2 bg-primary/5">
              <img src="./image/9 Custom Connect the Dots Generator Interface with Sample Result.png"
                alt="Custom connect the dots generator - create your own printable worksheets | connectthedotsprintable.online"
                class="w-full h-full object-cover" />
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Printing Guide Section -->
    <section class="py-16 bg-white">
      <div class="container mx-auto px-4">
        <h2 class="text-[clamp(1.8rem,4vw,2.5rem)] font-bold mb-10 text-center">
          Printing Guide for Connect the Dots Worksheets
        </h2>

        <div class="max-w-3xl mx-auto bg-light p-8 rounded-xl shadow-md">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <div>
              <h3 class="text-xl font-bold mb-4 flex items-center">
                <i class="fas fa-print text-primary mr-2"></i> Best Printing
                Settings
              </h3>
              <ul class="space-y-3 text-neutral/80">
                <li class="flex items-start">
                  <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                  <span>Use <strong>letter size paper (8.5" x 11")</strong> for
                    standard printing</span>
                </li>
                <li class="flex items-start">
                  <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                  <span>Set print quality to
                    <strong>"high" or "best"</strong> for clear dots</span>
                </li>
                <li class="flex items-start">
                  <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                  <span>Select <strong>"actual size"</strong> (not scaled) in
                    print options</span>
                </li>
                <li class="flex items-start">
                  <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                  <span>Print in <strong>black and white</strong> to save
                    ink</span>
                </li>
                <li class="flex items-start">
                  <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                  <span>Choose <strong>portrait orientation</strong> for most
                    designs</span>
                </li>
              </ul>
            </div>

            <div>
              <h3 class="text-xl font-bold mb-4 flex items-center">
                <i class="fas fa-file-pdf text-primary mr-2"></i> Download &
                Print Tips
              </h3>
              <ul class="space-y-3 text-neutral/80">
                <li class="flex items-start">
                  <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                  <span>Download the PDF version for the best printing
                    results</span>
                </li>
                <li class="flex items-start">
                  <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                  <span>For younger children, print at 125% scale for larger
                    dots</span>
                </li>
                <li class="flex items-start">
                  <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                  <span>Use thicker paper (cardstock) for longer-lasting
                    activities</span>
                </li>
                <li class="flex items-start">
                  <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                  <span>Save ink by deselecting "background graphics" in print
                    settings</span>
                </li>
              </ul>
            </div>
          </div>

          <div class="mt-8 pt-6 border-t border-gray-200">
            <a href="#" class="text-primary font-semibold hover:underline inline-flex items-center">
              View complete printing guide
              <i class="fas fa-arrow-right ml-1"></i>
            </a>
          </div>
        </div>
      </div>
    </section>

    <!-- FAQ Section -->
    <section class="py-16 bg-gray-50">
      <div class="container mx-auto px-4">
        <h2 class="text-[clamp(1.8rem,4vw,2.5rem)] font-bold mb-10 text-center">
          Frequently Asked Questions About Connect the Dots Printables
        </h2>

        <div class="max-w-3xl mx-auto">
          <div class="space-y-4" itemscope itemtype="https://schema.org/FAQPage">
            <!-- FAQ Item 1 -->
            <div class="bg-white rounded-lg shadow-sm overflow-hidden" itemprop="mainEntity" itemscope
              itemtype="https://schema.org/Question">
              <button
                class="faq-toggle w-full text-left px-6 py-4 font-semibold flex justify-between items-center focus:outline-none">
                <span itemprop="name">Are your connect the dots printables really free?</span>
                <i class="fas fa-plus text-primary transition-transform duration-300"></i>
              </button>
              <div class="faq-content hidden px-6 pb-4 text-neutral/70" itemprop="acceptedAnswer" itemscope
                itemtype="https://schema.org/Answer">
                <p itemprop="text">
                  Yes, all our connect the dots printables are completely free
                  to download and print. We don't require any payment or
                  subscription to access our basic printables. Some premium
                  designs may be available for a small fee, but they're
                  clearly marked.
                </p>
              </div>
            </div>

            <!-- FAQ Item 2 -->
            <div class="bg-white rounded-lg shadow-sm overflow-hidden" itemprop="mainEntity" itemscope
              itemtype="https://schema.org/Question">
              <button
                class="faq-toggle w-full text-left px-6 py-4 font-semibold flex justify-between items-center focus:outline-none">
                <span itemprop="name">What file formats are available for download?</span>
                <i class="fas fa-plus text-primary transition-transform duration-300"></i>
              </button>
              <div class="faq-content hidden px-6 pb-4 text-neutral/70" itemprop="acceptedAnswer" itemscope
                itemtype="https://schema.org/Answer">
                <p itemprop="text">
                  All our connect the dots printables are available in PDF
                  format, which is ideal for printing. Many designs also come
                  in high-resolution PNG image format. The PDF format is
                  recommended for the best printing results as it preserves
                  the layout and quality regardless of your device or printer.
                </p>
              </div>
            </div>

            <!-- FAQ Item 3 -->
            <div class="bg-white rounded-lg shadow-sm overflow-hidden" itemprop="mainEntity" itemscope
              itemtype="https://schema.org/Question">
              <button
                class="faq-toggle w-full text-left px-6 py-4 font-semibold flex justify-between items-center focus:outline-none">
                <span itemprop="name">Can I use these printables for commercial purposes?</span>
                <i class="fas fa-plus text-primary transition-transform duration-300"></i>
              </button>
              <div class="faq-content hidden px-6 pb-4 text-neutral/70" itemprop="acceptedAnswer" itemscope
                itemtype="https://schema.org/Answer">
                <p itemprop="text">
                  Our connect the dots printables are for personal and
                  educational use only. They cannot be used for commercial
                  purposes, including selling the printables or using them in
                  products for sale. If you're a teacher, you may use them in
                  your classroom and distribute them to your students.
                </p>
              </div>
            </div>

            <!-- FAQ Item 4 -->
            <div class="bg-white rounded-lg shadow-sm overflow-hidden" itemprop="mainEntity" itemscope
              itemtype="https://schema.org/Question">
              <button
                class="faq-toggle w-full text-left px-6 py-4 font-semibold flex justify-between items-center focus:outline-none">
                <span itemprop="name">How do I create a custom connect the dots printable?</span>
                <i class="fas fa-plus text-primary transition-transform duration-300"></i>
              </button>
              <div class="faq-content hidden px-6 pb-4 text-neutral/70" itemprop="acceptedAnswer" itemscope
                itemtype="https://schema.org/Answer">
                <p itemprop="text">
                  You can create custom connect the dots printables using our
                  generator tool. Simply upload an image, choose the number of
                  dots and difficulty level, and our tool will convert your
                  image into a connect the dots worksheet. You can then
                  download it in PDF or image format for printing.
                </p>
              </div>
            </div>

            <!-- FAQ Item 5 -->
            <div class="bg-white rounded-lg shadow-sm overflow-hidden" itemprop="mainEntity" itemscope
              itemtype="https://schema.org/Question">
              <button
                class="faq-toggle w-full text-left px-6 py-4 font-semibold flex justify-between items-center focus:outline-none">
                <span itemprop="name">Do you have connect the dots printables for adults?</span>
                <i class="fas fa-plus text-primary transition-transform duration-300"></i>
              </button>
              <div class="faq-content hidden px-6 pb-4 text-neutral/70" itemprop="acceptedAnswer" itemscope
                itemtype="https://schema.org/Answer">
                <p itemprop="text">
                  Yes, we have a large collection of connect the dots
                  printables designed specifically for adults. These include
                  more complex designs with hundreds of dots, intricate
                  patterns, and detailed images that provide a relaxing,
                  meditative activity. You can find them in our "Adult Connect
                  the Dots" category.
                </p>
              </div>
            </div>
          </div>

          <div class="text-center mt-8">
            <a href="#" class="inline-flex items-center text-primary font-semibold hover:underline">
              View all frequently asked questions
              <i class="fas fa-arrow-right ml-1"></i>
            </a>
          </div>
        </div>
      </div>
    </section>

    <!-- Newsletter Section -->
    <section class="py-16 bg-primary text-white">
      <div class="container mx-auto px-4">
        <div class="max-w-3xl mx-auto text-center">
          <h2 class="text-[clamp(1.8rem,4vw,2.5rem)] font-bold mb-4">
            Get New Connect the Dots Printables
          </h2>
          <p class="text-xl mb-8 text-white/90">
            Subscribe to our newsletter and be the first to receive new dot to
            dot printables and exclusive designs.
          </p>
          <!-- 假设的邮件订阅表单 -->
          <form class="flex flex-col sm:flex-row gap-3 max-w-lg mx-auto">
            <input type="email" placeholder="Your email address"
              class="flex-grow px-4 py-3 rounded-lg text-neutral focus:outline-none focus:ring-2 focus:ring-white"
              required />
            <button type="submit"
              class="bg-white text-primary px-6 py-3 rounded-lg font-semibold hover:bg-opacity-90 transition whitespace-nowrap">
              Subscribe Now
            </button>
          </form>
        </div>
      </div>
    </section>
  </main>

  <footer class="bg-neutral text-white pt-16 pb-8">
    <div class="container mx-auto px-4">
      <div class="grid grid-cols-1 md:grid-cols-4 gap-8 mb-12">
        <div>
          <div class="flex items-center mb-6">
            <i class="fas fa-pencil-ruler text-white text-3xl mr-2"></i>
            <span class="text-xl font-bold">ConnectTheDotsPrintable.online</span>
          </div>
          <p class="text-gray-400 mb-6">
            Your source for high-quality, free connect the dots printables for
            kids and adults.
          </p>
          <div class="flex space-x-4">
            <a href="#" class="text-gray-400 hover:text-white transition">
              <i class="fab fa-facebook-f"></i>
            </a>
            <a href="#" class="text-gray-400 hover:text-white transition">
              <i class="fab fa-twitter"></i>
            </a>
            <a href="#" class="text-gray-400 hover:text-white transition">
              <i class="fab fa-pinterest-p"></i>
            </a>
            <a href="#" class="text-gray-400 hover:text-white transition">
              <i class="fab fa-instagram"></i>
            </a>
          </div>
        </div>

        <div>
          <h3 class="text-lg font-bold mb-6">Printable Categories</h3>
          <ul class="space-y-3">
            <li>
              <a href="./printable-connect-the-dots.html" class="text-gray-400 hover:text-white transition">All
                Printables</a>
            </li>
            <li>
              <a href="#" class="text-gray-400 hover:text-white transition">Kids Connect the Dots</a>
            </li>
            <li>
              <a href="#" class="text-gray-400 hover:text-white transition">Adult Dot to Dot</a>
            </li>
            <li>
              <a href="#" class="text-gray-400 hover:text-white transition">Dot to Dot Worksheets</a>
            </li>
            <li>
              <a href="#" class="text-gray-400 hover:text-white transition">Themed Printables</a>
            </li>
          </ul>
        </div>

        <div>
          <h3 class="text-lg font-bold mb-6">Quick Links</h3>
          <ul class="space-y-3">
            <li>
              <a href="#" class="text-gray-400 hover:text-white transition">About Us</a>
            </li>
            <li>
              <a href="#" class="text-gray-400 hover:text-white transition">Custom Generator</a>
            </li>
            <li>
              <a href="#" class="text-gray-400 hover:text-white transition">Printing Guide</a>
            </li>
            <li>
              <a href="#" class="text-gray-400 hover:text-white transition">FAQ</a>
            </li>
            <li>
              <a href="#" class="text-gray-400 hover:text-white transition">Contact Us</a>
            </li>
          </ul>
        </div>

        <div>
          <h3 class="text-lg font-bold mb-6">Legal</h3>
          <ul class="space-y-3">
            <li>
              <a href="./privacy.html" class="text-gray-400 hover:text-white transition">Privacy Policy</a>
            </li>
            <li>
              <a href="./terms.html" class="text-gray-400 hover:text-white transition">Terms of Service</a>
            </li>
            <li>
              <a href="#" class="text-gray-400 hover:text-white transition">Copyright Information</a>
            </li>
            <li>
              <a href="#" class="text-gray-400 hover:text-white transition">DMCA Notice</a>
            </li>
          </ul>
        </div>
      </div>

      <div class="pt-8 border-t border-gray-800 text-center text-gray-500 text-sm">
        <p>
          &copy; 2025 ConnectTheDotsPrintable.online. All rights reserved.
        </p>
        <p class="mt-2">
          All printables are for personal and educational use only.
        </p>
      </div>
    </div>
  </footer>

  <!-- JavaScript -->
  <script>
    // Mobile menu toggle
    document
      .getElementById("mobile-menu-button")
      .addEventListener("click", function () {
        const mobileMenu = document.getElementById("mobile-menu");
        mobileMenu.classList.toggle("hidden");
      });

    // FAQ toggles
    document.querySelectorAll(".faq-toggle").forEach((toggle) => {
      toggle.addEventListener("click", function () {
        const content = this.nextElementSibling;
        const icon = this.querySelector("i");

        content.classList.toggle("hidden");
        icon.classList.toggle("fa-plus");
        icon.classList.toggle("fa-minus");
      });
    });

    // Smooth scrolling for anchor links
    document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
      anchor.addEventListener("click", function (e) {
        e.preventDefault();
        const targetId = this.getAttribute("href");
        if (targetId !== "#") {
          const targetElement = document.querySelector(targetId);
          if (targetElement) {
            targetElement.scrollIntoView({
              behavior: "smooth",
            });
          }
        }
      });
    });

    // --- ADDED: Image Download Logic ---
    async function downloadImage(url, filename) {
      try {
        // Fetch the image data as a blob
        const response = await fetch(url);
        if (!response.ok) throw new Error("Network response was not ok.");
        const blob = await response.blob();

        const objectUrl = window.URL.createObjectURL(blob);

        const a = document.createElement("a");
        a.style.display = "none";
        a.href = objectUrl;
        a.download = filename || "printable.png"; // Use provided filename or a default
        document.body.appendChild(a);
        a.click();

        window.URL.revokeObjectURL(objectUrl);
        document.body.removeChild(a);
      } catch (error) {
        console.error("Download failed:", error);
        alert(
          "Sorry, the image could not be downloaded. Please check the console for errors."
        );
      }
    }

    document.querySelectorAll(".download-btn").forEach((button) => {
      button.addEventListener("click", function (e) {
        e.preventDefault(); // Prevent the default link behavior

        // Get the image URL and filename from the data attributes
        const imageUrl = this.dataset.imgSrc;
        const filename = this.dataset.filename;

        if (imageUrl) {
          downloadImage(imageUrl, filename);
        } else {
          console.error(
            "No image source (data-img-src) found for this button."
          );
        }
      });
    });

    const imageLoader = document.getElementById("imageLoader");
    const fileNameSpan = document.getElementById("fileName");
    const hintRadios = document.querySelectorAll('input[name="imageHint"]');
    const thresholdSlider = document.getElementById("thresholdSlider");
    const pointCountSlider = document.getElementById("pointCountSlider");
    const traceAmountSlider = document.getElementById("traceAmountSlider");
    const previewContainer = document.getElementById("previewContainer");
    const placeholder = document.getElementById("placeholder");
    // The other canvases are kept for potential off-screen drawing but won't be displayed.
    // dotsCanvas is our main, visible canvas.
    const dotsCanvas = document.getElementById("dotsCanvas");
    const loader = document.getElementById("loader");
    const downloadBtn = document.getElementById("downloadBtn");

    // --- Global Variables ---
    let originalImage = null;
    let currentPoints = [];
    let allContours = null;

    // --- OpenCV Initialization ---
    function onOpenCvReady() {
      if (loader)
        loader.textContent = "OpenCV.js loaded. Ready to process images.";
    }
    const cvInterval = setInterval(() => {
      if (typeof cv !== "undefined") {
        onOpenCvReady();
        clearInterval(cvInterval);
      }
    }, 100);

    // --- Event Listeners ---
    if (imageLoader)
      imageLoader.addEventListener("change", handleImageUpload);
    if (hintRadios)
      hintRadios.forEach((radio) =>
        radio.addEventListener("change", updateDisplay)
      );
    if (downloadBtn) downloadBtn.addEventListener("click", handleDownload);

    // --- Main Functions ---
    function handleImageUpload(e) {
      const file = e.target.files[0];
      if (!file) {
        if (fileNameSpan) fileNameSpan.textContent = "No file chosen";
        return;
      }
      if (fileNameSpan) fileNameSpan.textContent = file.name;
      const reader = new FileReader();
      reader.onload = function (event) {
        originalImage = new Image();
        originalImage.onload = () => {
          if (placeholder) placeholder.style.display = "none";
          processImage();
        };
        originalImage.src = event.target.result;
      };
      reader.readAsDataURL(file);
    }

    function handleDownload() {
      if (!originalImage || dotsCanvas.style.display === "none") return;
      // The main canvas (dotsCanvas) now contains the complete image, so we download it directly.
      const link = document.createElement("a");
      link.download = "connect-the-dots.png";
      link.href = dotsCanvas.toDataURL("image/png");
      link.click();
    }

    function processImage() {
      if (!originalImage || typeof cv === "undefined") return;

      if (downloadBtn) downloadBtn.disabled = false;

      // 1. Calculate the responsive display size based on the container width.
      const maxWidth = previewContainer.clientWidth;
      let displayW = originalImage.width;
      let displayH = originalImage.height;

      if (originalImage.width > maxWidth) {
        const scaleRatio = maxWidth / originalImage.width;
        displayW = maxWidth;
        displayH = Math.floor(originalImage.height * scaleRatio);
      }

      // 2. Set the container and the main canvas to this responsive size.
      previewContainer.style.aspectRatio = displayW / displayH;
      dotsCanvas.width = displayW;
      dotsCanvas.height = displayH;

      // 3. Create a resized image in memory (Mat object) for processing.
      // All subsequent OpenCV operations use this resized version.
      let src = cv.imread(originalImage);
      let resizedSrc = new cv.Mat();
      cv.resize(
        src,
        resizedSrc,
        new cv.Size(displayW, displayH),
        0,
        0,
        cv.INTER_AREA
      );

      let gray = new cv.Mat(),
        binary = new cv.Mat(),
        contours = new cv.MatVector(),
        hierarchy = new cv.Mat();
      cv.cvtColor(resizedSrc, gray, cv.COLOR_RGBA2GRAY, 0);
      cv.threshold(
        gray,
        binary,
        parseInt(thresholdSlider.value, 10),
        255,
        cv.THRESH_BINARY_INV
      );
      cv.findContours(
        binary,
        contours,
        hierarchy,
        cv.RETR_CCOMP,
        cv.CHAIN_APPROX_NONE
      );

      if (allContours) allContours.delete();
      allContours = contours.clone();

      // 4. Find the longest contour from the resized image.
      let mainContour = null;
      if (contours.size() > 0) {
        let maxLength = 0,
          longestContourIndex = -1;
        for (let i = 0; i < contours.size(); i++) {
          let len = cv.arcLength(contours.get(i), true);
          if (len > maxLength) {
            maxLength = len;
            longestContourIndex = i;
          }
        }
        if (longestContourIndex !== -1)
          mainContour = contours.get(longestContourIndex);
      }

      // 5. Calculate point positions based on the resized contour.
      currentPoints = [];
      if (mainContour) {
        const perimeter = cv.arcLength(mainContour, true);
        const targetPointCount = parseInt(pointCountSlider.value, 10);
        if (perimeter > 0) {
          const step = perimeter / targetPointCount;
          const contourPoints = [];
          for (let i = 0; i < mainContour.data32S.length; i += 2)
            contourPoints.push({
              x: mainContour.data32S[i],
              y: mainContour.data32S[i + 1],
            });
          if (contourPoints.length > 1) contourPoints.push(contourPoints[0]);

          let accumulatedDistance = 0,
            targetIndex = 0;
          const targetDistances = Array.from(
            { length: targetPointCount },
            (_, i) => i * step
          );

          if (contourPoints.length > 0) {
            currentPoints.push(contourPoints[0]);
            targetIndex++;
          }

          for (let i = 1; i < contourPoints.length; i++) {
            const p1 = contourPoints[i - 1],
              p2 = contourPoints[i];
            const segmentLength = Math.sqrt(
              Math.pow(p2.x - p1.x, 2) + Math.pow(p2.y - p1.y, 2)
            );
            while (
              targetIndex < targetDistances.length &&
              accumulatedDistance + segmentLength >=
              targetDistances[targetIndex]
            ) {
              const distanceNeeded =
                targetDistances[targetIndex] - accumulatedDistance;
              const ratio =
                segmentLength > 0 ? distanceNeeded / segmentLength : 0;
              currentPoints.push({
                x: p1.x + ratio * (p2.x - p1.x),
                y: p1.y + ratio * (p2.y - p1.y),
              });
              targetIndex++;
            }
            accumulatedDistance += segmentLength;
          }
        }
      }

      updateDisplay();

      // 7. Clean up memory.
      src.delete();
      resizedSrc.delete();
      gray.delete();
      binary.delete();
      contours.delete();
      hierarchy.delete();
    }

    function updateDisplay() {
      if (!originalImage) return;

      const selectedHint = document.querySelector(
        'input[name="imageHint"]:checked'
      ).value;
      const mainCtx = dotsCanvas.getContext("2d");

      mainCtx.fillStyle = "white";
      mainCtx.fillRect(0, 0, dotsCanvas.width, dotsCanvas.height);

      dotsCanvas.style.display = "block";

      if (selectedHint === "contrast") {
        drawContrastBackgroundOn(mainCtx);
        drawTraceBackgroundOn(mainCtx);
      } else if (selectedHint === "trace") {
        drawTraceBackgroundOn(mainCtx);
      }

      drawDotsAndNumbersOn(mainCtx, currentPoints);
    }

    function drawDotsAndNumbersOn(ctx, points) {
      if (!points || points.length === 0) return;
      ctx.fillStyle = "black";
      ctx.font = "14px Arial";
      ctx.textAlign = "center";
      ctx.textBaseline = "middle";
      points.forEach((point, index) => {
        if (!point) return;
        ctx.beginPath();
        ctx.arc(point.x, point.y, 3, 0, 2 * Math.PI);
        ctx.fill();
        ctx.fillText(index + 1, point.x, point.y - 15);
      });
    }

    function drawTraceBackgroundOn(ctx) {
      if (!allContours) return;
      const traceAmount = parseInt(traceAmountSlider.value, 10) / 100;
      ctx.strokeStyle = "rgba(0, 0, 0, 0.4)";
      ctx.lineWidth = 1;
      for (let i = 0; i < allContours.size(); ++i) {
        const contour = allContours.get(i);
        if (contour.rows < 2) continue;
        const pointsToDraw = Math.floor(contour.rows * traceAmount);
        if (pointsToDraw < 1) continue;
        ctx.beginPath();
        ctx.moveTo(contour.data32S[0], contour.data32S[1]);
        for (let j = 2; j < pointsToDraw * 2; j += 2) {
          ctx.lineTo(contour.data32S[j], contour.data32S[j + 1]);
        }
        ctx.stroke();
      }
    }

    function drawContrastBackgroundOn(ctx) {
      const canvas = ctx.canvas;
      const threshold = parseInt(thresholdSlider.value, 10);

      // Draw the original image, scaled to fit the responsive canvas.
      ctx.drawImage(originalImage, 0, 0, canvas.width, canvas.height);

      const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
      const data = imageData.data;
      for (let i = 0; i < data.length; i += 4) {
        const brightness =
          0.299 * data[i] + 0.587 * data[i + 1] + 0.114 * data[i + 2];
        const color = brightness <= threshold ? 0 : 255;
        data[i] = data[i + 1] = data[i + 2] = color;
        data[i + 3] = 255; // Ensure full opacity
      }
      ctx.putImageData(imageData, 0, 0);
    }

    // --- Debounced Slider Handling for Performance ---
    let debounceTimer;
    function debouncedProcessImage() {
      clearTimeout(debounceTimer);
      debounceTimer = setTimeout(() => {
        if (originalImage) processImage();
      }, 16); // ~60fps
    }
    [thresholdSlider, pointCountSlider, traceAmountSlider].forEach(
      (slider) => {
        if (slider) {
          slider.addEventListener("input", (e) => {
            const span = e.target.parentElement.querySelector("span");
            if (span) span.textContent = e.target.value;
            debouncedProcessImage();
          });
        }
      }
    );
  </script>
</body>

</html>